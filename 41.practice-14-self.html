<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
            crossorigin="anonymous"
        />
        <link
            rel="stylesheet"
            href="fontawesome-free-6.1.1-web/css/all.min.css"
        />
        <style type="text/css">
            .card {
                border: 1px solid #eee;
                margin: 5px;
            }

            img {
                vertical-align: bottom;
                margin: 5px;
            }

            .cart-area {
                width: 300px;
                border: 1px solid #eee;
                border-radius: 5px;
            }

            .envelope-area {
                margin-right: 10px;
            }
        </style>
    </head>
    <body>
        <div class="container position-relative">
            <div class="envelope-area position-absolute top-0 end-0">
                <i class="fa-solid fa-envelope"></i>
            </div>
            <h3>嗨，歡迎來丹德里恩的冰品店！</h3>
            <p>請選擇您要購買的冰棒口味及數量：</p>
            <div class="card-area d-flex">
                <div class="card">
                    <img src="./pics/ice_mango.jpeg" alt="" />
                    <p class="fw-bold mx-1 mb-0">芒果冰棒</p>
                    <p class="text-danger ms-1 mb-5">$40</p>
                    <div
                        class="button-area position-absolute bottom-0 end-0 me-1 mb-1"
                    >
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-heart"></i>
                        </button>
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-cart-shopping"></i>
                        </button>
                    </div>
                </div>
                <div class="card">
                    <img src="./pics/ice_lemon.jpeg" alt="" />
                    <p class="fw-bold mx-1 mb-0">檸檬冰棒</p>
                    <p class="text-danger ms-1 mb-5">$35</p>
                    <div
                        class="button-area position-absolute bottom-0 end-0 me-1 mb-1"
                    >
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-heart"></i>
                        </button>
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-cart-shopping"></i>
                        </button>
                    </div>
                </div>
                <div class="card">
                    <img src="./pics/ice_passionfruit.jpeg" alt="" />
                    <p class="fw-bold mx-1 mb-0">百香果冰棒</p>
                    <p class="text-danger ms-1 mb-5">$35</p>
                    <div
                        class="button-area position-absolute bottom-0 end-0 me-1 mb-1"
                    >
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-heart"></i>
                        </button>
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-cart-shopping"></i>
                        </button>
                    </div>
                </div>
                <div class="card">
                    <img src="./pics/ice_strawberry.jpeg" alt="" />
                    <p class="fw-bold mx-1 mb-0">草莓冰棒</p>
                    <p class="text-danger ms-1 mb-5">$40</p>
                    <div
                        class="button-area position-absolute bottom-0 end-0 me-1 mb-1"
                    >
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-heart"></i>
                        </button>
                        <button type="button" class="btn btn-primary">
                            <i class="fa-solid fa-cart-shopping"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="cart-area d-flex flex-column mx-auto">
                <p class="mx-2 mt-2 mb-0 pb-2 border-bottom">購物車</p>
                <div class="table-area mx-2">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">品名</th>
                                <th scope="col" class="text-center">單價</th>
                                <th scope="col" class="text-center">數量</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- <tr>
                                <th scope="row">1</th>
                                <td>Mark</td>
                                <td>Otto</td>
                            </tr> -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <script src="./js/jquery-3.6.0.min.js"></script>
        <script>
            let isActive = true;

            $('button:first-child').on('click', (e) => {
                if (isActive) {
                    isActive = !isActive;
                    $(e.target).append(
                        `<i 
                            class="fa-solid fa-heart flying-heart"
                            style="
                                color: red;
                                opacity: 0.5;
                                position: absolute;
                                top: -10px;
                                right: 61px;
                                transition: 0.5s;
                                z-index: 100;
                            "
                        >
                        </i>`
                    )

                    // console.log($('.envelope-area').position().top);
                    // console.log($('.envelope-area').position().left);
                    
                    console.log($(e.target).closest('.card').index());

                    const envelopeAreaLeft = $('.envelope-area').position().left - ($(e.target).closest('.card').outerWidth() - 4) - $(e.target).closest('.card').index() * $(e.target).closest('.card').outerWidth(true);
                    const topOffset = $(e.target).closest('.card').outerHeight() + 20;

                    // console.log(envelopeAreaLeft);

                    $('.flying-heart').css('right', `-${envelopeAreaLeft}px`);
                    $('.flying-heart').css('top', `-${topOffset}px`);

                    setTimeout(() => {
                        $('.flying-heart').css('top', `-${topOffset + 12}px`);
                    }, 1000)

                    setTimeout(() => {
                        $('.flying-heart').remove();
                    }, 1500)

                    setTimeout(() => {
                        isActive = !isActive;
                    }, 2000)
                }
            })
        </script>
    </body>
</html>
